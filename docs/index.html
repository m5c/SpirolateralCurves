<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Page metadata, webapp support for iOS shortcut applications (fullscreen)-->
        <meta name="mobile-web-app-capable" content="yes" />
        <meta
            name="viewport"
            content="viewport-fit=cover, target-densitydpi=device-dpi, width=device-width, user-scalable=no, maximum-scale=1, minimum-scale=1"
        />
        <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png" />
        <!-- <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png" />
        <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png" /> -->
        <link rel="icon" href="images/favicon.ico" />
        <link rel="manifest" href="manifest.json" />
        <meta name="apple-mobile-web-app-title" content="Spirolateral Curves" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta charset="utf-8" />
        <title>Spirolateral Curves</title>

        <script type="module" src="bundle.js"></script>
        <meta charset="UTF-8" />
        <style>
            html,
            body {
                margin: 0;
                width: 100%;
                height: 100%;
            }

            body {
                display: flex;
                align-items: center;
                justify-content: center;
                background: #000; /* optional */
            }

            svg {
                width: 100%;
                height: 100%;
                max-width: 100vw;
                max-height: 100vh;
                display: block;
            }

            /* Bottom-right overlay fur current render parameters */
            .overlay {
                display: flex;
                position: absolute;
                right: 12px;
                top: 25px;
                font-size: 11px;
                font-family: system-ui, sans-serif;
                color: #aaa;
                opacity: 0.85;
                user-select: none;
                white-space: nowrap;
                gap: 0.15em;
            }

            a {
                color: inherit; /* same color as text */
                font: inherit; /* same font family, size, weight */
                text-decoration: none; /* remove underline */
            }

            /* The rest is for the virtual keyboard*/
            .virtual-keys {
                position: fixed;
                bottom: 1.5rem;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                grid-template-columns: repeat(auto-fit, minmax(44px, 1fr));
                gap: 0.2rem;
                z-index: 9999;
                padding: 0.5rem;
            }

            .virtual-keys button {
                font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial,
                    sans-serif;
                font-size: 1rem;
                font-weight: 600;

                width: min(44px, 10vw); /* max 44px, shrink on small screens */
                aspect-ratio: 1 / 1; /* keep square: height = width */

                border-radius: 6px;
                border: 1px solid #bbb;
                background: linear-gradient(#fdfdfd, #e6e6e6);

                box-shadow: 0 2px 0 #aaa, 0 3px 5px rgba(0, 0, 0, 0.25);

                color: #333;
                cursor: pointer;

                touch-action: manipulation;
            }

            .virtual-keys button:active {
                transform: translateY(2px);
                box-shadow: 0 1px 0 #aaa, 0 1px 2px rgba(0, 0, 0, 0.3);
            }

            .virtual-keys {
                pointer-events: none;
            }

            .virtual-keys button {
                pointer-events: auto;
            }

            .virtual-keys {
                grid-auto-flow: column;

                /* enable for smaller buttons */
                /* transform: translateX(-50%) scale(0.5); */
                /* transform-origin: bottom center; */
            }

            /** only active on computers (excludes touch devices) */
            @media (hover: hover) {
                /* no need for virtual keys */
                .virtual-keys {
                    display: none;
                }

                /* enable welcome dialogue */
                .instructions {
                    display: flex;
                }
            }

            @media only screen and (max-width: 800px) {
                .nophone {
                    display: none;
                }
            }

            .virtual-keys button {
                -webkit-tap-highlight-color: transparent;
            }

            .key-spacer {
                flex: 0 0 3px; /* exact width of spacer */
            }

            /*The rest are floating instructions for desktop version*/
            .instructions {
                position: fixed;
                top: 20px;
                left: 20px;
                background: rgba(0, 0, 0, 0.85);
                color: #fff;
                padding: 15px 20px;
                border-radius: 10px;
                font-size: 14px;
                line-height: 1.6;
                max-width: 260px;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                border: 2px solid #fff; /* frame around panel */
            }

            .instructions h3 {
                margin: 0 0 10px 0;
                font-size: 16px;
                text-align: center;
                border-bottom: 1px solid rgba(255, 255, 255, 0.3);
                padding-bottom: 5px;
                font-family: Monaco, monospace;
            }

            .instructions ul {
                list-style: none;
                padding: 0;
                margin: 0;
            }

            .instructions li {
                margin-bottom: 6px;
                font-family: Monaco, monospace;
            }

            .instructions kbd {
                background: rgba(255, 255, 255, 0.2);
                border-radius: 4px;
                padding: 2px 6px;
                font-family: Monaco, monospace;
                font-weight: bold;
            }
        </style>
    </head>
    <body>
        <!-- Overlay text -->
        <div class="overlay">
            <div id="param-report"></div>
            <br />
            <a href="https://github.com/m5c/SpirolateralCurves">m5c</a>
        </div>

        <div class="virtual-keys">
            <button data-key="r" class="nophone">R</button>
            <span class="key-spacer" aria-hidden="true"></span>

            <button data-key="1">1</button>
            <button data-key="2">2</button>
            <button data-key="3">3</button>
            <button data-key="4" class="nophone">4</button>
            <button data-key="5" class="nophone">5</button>
            <button data-key="6" class="nophone">6</button>
            <button data-key="7" class="nophone">7</button>
            <button data-key="8" class="nophone">8</button>
            <button data-key="9" class="nophone">9</button>
            <button data-key="0" class="nophone">0</button>
            <span class="key-spacer" aria-hidden="true"></span>

            <button data-key="q">α-</button>
            <button data-key="w">α+</button>
            <span class="key-spacer" aria-hidden="true"></span>

            <button data-key="-">β-</button>
            <button data-key="=">β+</button>
            <span class="key-spacer" aria-hidden="true"></span>
            <button data-key="[">t-</button>
            <button data-key="]">t+</button>
        </div>
        <!-- INLINE SVG - content is dynamically created-->
        <svg id="curve"></svg>

        <div class="instructions" id="instructions">
            <ul class="commands">
                <li><kbd>r</kbd>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; load random</li>
                <li><kbd>0 - 9</kbd>: &nbsp;&nbsp;&nbsp;load preset</li>
                <li><kbd>q / w</kbd>: &nbsp;&nbsp;&nbsp;initial heading (α)</li>
                <li><kbd>- / +</kbd>: &nbsp;&nbsp;&nbsp;turn angle (β)</li>
                <li><kbd>[ / ]</kbd>: &nbsp;&nbsp;&nbsp;reset threshold (t)</li>
                <li><kbd>v</kbd>: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;visit project page</li>
                <li><kbd>x</kbd>: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hide keycodes</li>
            </ul>
        </div>
    </body>
</html>
